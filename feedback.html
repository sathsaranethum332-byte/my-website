<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ROLLEX GAMING - Live Feedback</title>

<style>

body{
margin:0;
font-family:'Segoe UI',sans-serif;
background: linear-gradient(-45deg,#0f2027,#240176,#8f00ff,#00f0ff);
background-size:400% 400%;
animation:bgMove 10s ease infinite;
color:white;
text-align:center;
overflow-x:hidden;
}

@keyframes bgMove{
0%{background-position:0% 50%}
50%{background-position:100% 50%}
100%{background-position:0% 50%}
}

.container{
max-width:650px;
margin:60px auto;
background:rgba(0,0,0,0.7);
padding:30px;
border-radius:20px;
backdrop-filter:blur(15px);
box-shadow:0 0 40px #00f0ff;
animation:fadeIn 1s ease;
}

@keyframes fadeIn{
from{opacity:0; transform:translateY(20px);}
to{opacity:1; transform:translateY(0);}
}

input, textarea{
width:100%;
padding:12px;
margin:10px 0;
border:none;
border-radius:10px;
background:#111;
color:white;
box-shadow:0 0 10px #8f00ff inset;
}

button{
padding:12px;
border:none;
border-radius:10px;
cursor:pointer;
margin:8px 0;
font-weight:bold;
background:linear-gradient(45deg,#00f0ff,#8f00ff);
color:white;
transition:0.3s;
}

button:hover{
transform:scale(1.05);
box-shadow:0 0 20px #00f0ff;
}

.feedback{
background:#111;
padding:15px;
border-radius:12px;
margin:15px 0;
box-shadow:0 0 20px #00f0ff;
position:relative;
animation:pop 0.4s ease;
}

@keyframes pop{
from{transform:scale(0.9); opacity:0;}
to{transform:scale(1); opacity:1;}
}

.delete-btn{
background:red;
position:absolute;
right:10px;
top:10px;
}

/* Admin panel hidden by default */
#adminPanel{
display:none;
}

</style>
</head>
<body>

<div class="container">

<h2 style="color:#00f0ff;text-shadow:0 0 15px #00f0ff;">
üéÆ LIVE GAMING FEEDBACK
</h2>

<!-- üîê ADMIN PANEL -->
<div id="adminPanel">
<h3>Admin Login</h3>
<input type="email" id="adminEmail" placeholder="Admin Email">
<input type="password" id="adminPass" placeholder="Admin Password">
<button onclick="adminLogin()">Login</button>
<hr>
</div>

<!-- CUSTOMER AREA -->
<input type="text" id="name" placeholder="Your Name">
<textarea id="message" placeholder="Your Feedback"></textarea>
<button onclick="addFeedback()">Submit Feedback</button>

<div id="feedbackList"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

/* üî• FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyBuM8CLvGn_e2nn7KNv8BK5XaCU9qoDi5U",
  authDomain: "feedback-dae72.firebaseapp.com",
  databaseURL: "https://feedback-dae72-default-rtdb.firebaseio.com",
  projectId: "feedback-dae72",
  storageBucket: "feedback-dae72.firebasestorage.app",
  messagingSenderId: "1090089969045",
  appId: "1:1090089969045:web:0d8cca44747605026fc29c"
};

const ADMIN_EMAIL = "nethumsathsara100@gmail.com";

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

let currentUser = null;

/* üîê LOGIN STATE CHECK */
onAuthStateChanged(auth,(user)=>{
currentUser = user;

if(user && user.email === ADMIN_EMAIL){
document.getElementById("adminPanel").style.display="block";
}

loadFeedback();
});

/* üîê ADMIN LOGIN */
window.adminLogin = function(){
const email = document.getElementById("adminEmail").value;
const pass = document.getElementById("adminPass").value;

signInWithEmailAndPassword(auth,email,pass)
.then(()=>alert("Admin Login Success"))
.catch(err=>alert(err.message));
}

/* ‚ûï ADD FEEDBACK */
window.addFeedback = function(){
const name = document.getElementById("name").value.trim();
const message = document.getElementById("message").value.trim();

if(!name || !message){
alert("Fill all fields");
return;
}

push(ref(db,"feedbacks"),{
name:name,
message:message,
time:Date.now()
});

document.getElementById("name").value="";
document.getElementById("message").value="";
}

/* üì• LOAD FEEDBACK */
function loadFeedback(){
onValue(ref(db,"feedbacks"),(snapshot)=>{
const data = snapshot.val();
const list = document.getElementById("feedbackList");
list.innerHTML="";

if(data){
Object.entries(data)
.sort((a,b)=>b[1].time - a[1].time)
.forEach(([key,f])=>{

list.innerHTML += `
<div class="feedback">
<strong>${f.name}</strong>
${currentUser && currentUser.email===ADMIN_EMAIL 
? `<button class="delete-btn" onclick="deleteFeedback('${key}')">Delete</button>` 
: ""}
<p>${f.message}</p>
</div>
`;
});
}
});
}

/* ‚ùå DELETE (ADMIN ONLY FRONTEND CHECK) */
window.deleteFeedback = function(key){
if(currentUser && currentUser.email===ADMIN_EMAIL){
remove(ref(db,"feedbacks/"+key));
}
}

</script>

</body>
</html>
